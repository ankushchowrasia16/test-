<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Universal Unit Converter - Phase 3 Finale</title>
    <meta name="description" content="Professional Universal Unit Converter with 24 categories and 250+ units.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@300;400;600;800&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* =========================================
           CORE VARIABLES & THEMES
           ========================================= */
        :root {
            /* MATRIX THEME (DEFAULT) */
            --primary: #00FF41;
            --secondary: #008F11;
            --bg: #050505;
            --surface: #0a0f0a;
            --surface-hover: #0f1a0f;
            --text: #e0e0e0;
            --text-muted: #4af25d;
            --border: #003300;
            --glass: rgba(0, 20, 0, 0.7);
            --shadow: 0 8px 32px rgba(0, 255, 65, 0.1);

            /* TYPOGRAPHY */
            --font-main: 'Outfit', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;

            /* ANIMATIONS */
            --ease-out: cubic-bezier(0.215, 0.61, 0.355, 1);
            --ease-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        body.theme-cyberpunk {
            --primary: #ff00ff;
            --secondary: #00e5ff;
            --bg: #0a000f;
            --surface: #1a0025;
            --surface-hover: #2a0035;
            --text: #ffffff;
            --text-muted: #ff80ff;
            --border: #550055;
            --glass: rgba(40, 0, 60, 0.7);
            --shadow: 0 8px 32px rgba(255, 0, 255, 0.2);
        }

        body.theme-light {
            --primary: #2563eb;
            --secondary: #3b82f6;
            --bg: #f8fafc;
            --surface: #ffffff;
            --surface-hover: #f1f5f9;
            --text: #0f172a;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --glass: rgba(255, 255, 255, 0.8);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body.theme-oled {
            --primary: #ffffff;
            --secondary: #888888;
            --bg: #000000;
            --surface: #000000;
            --surface-hover: #111111;
            --text: #ffffff;
            --text-muted: #888888;
            --border: #333333;
            --glass: rgba(0, 0, 0, 0.9);
            --shadow: none;
        }

        /* =========================================
           RESET & BASE STYLES
           ========================================= */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            outline: none;
            -webkit-tap-highlight-color: transparent;
        }

        html,
        body {
            width: 100%;
            min-height: 100vh;
            overflow-x: hidden;
            background-color: var(--bg);
            color: var(--text);
            font-family: var(--font-main);
            transition: background-color 0.4s ease, color 0.4s ease;
            scroll-behavior: smooth;
        }

        /* Background Animation */
        .bg-anim {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-image: url('https://raw.githubusercontent.com/ankushchowrasia/universalunitconconverter/9fdd8e6a855969cdb8af11308bfe41672fdf4f3e/unnamed.jpg');
            background-size: cover;
            background-position: center;
            opacity: 0.15;
            z-index: -1;
            pointer-events: none;
            /* Optimized Animation using transform */
            animation: bgBreath 20s ease-in-out infinite alternate;
            will-change: transform;
        }

        @keyframes bgBreath {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.1);
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        /* =========================================
           ICON ANIMATION CSS (IMMUTABLE)
           Copied exactly as requested.
           ========================================= */

        /* Generic neon glow helper */
        .neon-glow {
            filter: drop-shadow(0 0 6px #00ff41);
        }

        .cat-icon svg {
            width: 60px;
            height: 60px;
            display: block;
            overflow: visible;
        }

        /* 1 Length */
        .length .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .length .draw-anim {
            stroke-dasharray: 120;
            stroke-dashoffset: 120;
            animation: drawLen 1.6s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .length .draw-anim-delayed {
            stroke-dasharray: 40;
            stroke-dashoffset: 40;
            animation: drawLen 1.6s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.2s;
        }

        .length .fade-ticks {
            opacity: 0;
            animation: fade-in-ticks 1.6s ease infinite alternate;
        }

        @keyframes drawLen {
            0% {
                stroke-dashoffset: 120;
            }

            100% {
                stroke-dashoffset: 0;
            }
        }

        @keyframes fade-in-ticks {
            0% {
                opacity: 0;
                transform: translateY(-5px);
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 2 Weight */
        .weight .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .weight .draw-anim {
            stroke-dasharray: 150;
            stroke-dashoffset: 150;
            animation: draw-line 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        .weight .draw-anim-delayed {
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: draw-line 2s cubic-bezier(0.4, 0, 0.2, 1) infinite;
            animation-delay: 0.4s;
        }

        .weight .balance-sway {
            transform-origin: 50% 25px;
            animation: sway 4s ease-in-out infinite;
        }

        @keyframes draw-line {

            0%,
            40%,
            80% {
                stroke-dashoffset: 0;
                opacity: 1;
            }

            100%,
            0% {
                stroke-dashoffset: 150;
                opacity: 1;
            }
        }

        /* Adjusted slightly for loop compatibility if needed, else strict copy */
        @keyframes sway {

            0%,
            100% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(5deg);
            }

            75% {
                transform: rotate(-5deg);
            }
        }

        /* 3 Temperature */
        .temp .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .temp .icon-fill {
            fill: var(--primary);
            stroke: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .temp .draw-anim {
            stroke-dasharray: 300;
            stroke-dashoffset: 300;
            animation: draw-shell 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .temp .temp-rise {
            stroke-dasharray: 60;
            stroke-dashoffset: 60;
            stroke-width: 6;
            animation: rise-liquid 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.5s;
        }

        .temp .fade-ticks {
            opacity: 0;
            animation: fade-ticks-temp 2s ease infinite alternate;
            animation-delay: 0.3s;
        }

        .temp .bulb-pulse {
            animation: pulse-opacity 2s ease infinite alternate;
        }

        @keyframes draw-shell {
            0% {
                stroke-dashoffset: 300;
            }

            100% {
                stroke-dashoffset: 0;
            }
        }

        @keyframes rise-liquid {
            0% {
                stroke-dashoffset: 60;
            }

            100% {
                stroke-dashoffset: 10;
            }
        }

        @keyframes fade-ticks-temp {
            0% {
                opacity: 0;
                transform: translateX(5px);
            }

            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse-opacity {
            0% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        /* 4 Time */
        .time .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .time .draw-anim {
            stroke-dasharray: 300;
            stroke-dashoffset: 300;
            animation: draw-circle 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .time .hands-anim {
            transform-origin: 50% 55%;
            animation: spin-hands 4s linear infinite;
        }

        .time .fade-ticks {
            opacity: 0;
            animation: fade-ticks-time 2s ease infinite alternate;
            animation-delay: 0.5s;
        }

        @keyframes draw-circle {
            0% {
                stroke-dashoffset: 300;
            }

            100% {
                stroke-dashoffset: 0;
            }
        }

        @keyframes spin-hands {
            0% {
                transform: rotate(0deg) scale(0);
                opacity: 0;
            }

            20% {
                transform: rotate(0deg) scale(1);
                opacity: 1;
            }

            100% {
                transform: rotate(360deg) scale(1);
                opacity: 1;
            }
        }

        @keyframes fade-ticks-time {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 5 Area */
        .area .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .area .draw-boundary {
            stroke-dasharray: 240;
            stroke-dashoffset: 240;
            animation: draw-square 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .area .draw-grid {
            stroke-dasharray: 60;
            stroke-dashoffset: 60;
            stroke-width: 1.5;
            opacity: 0.7;
            animation: draw-grid-lines 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.5s;
        }

        .area .draw-arrows {
            stroke-dasharray: 70;
            stroke-dashoffset: 70;
            animation: draw-arrows-anim 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.8s;
        }

        .area .area-fill {
            fill: var(--primary);
            fill-opacity: 0;
            animation: fill-pulse 2s ease infinite alternate;
        }

        @keyframes draw-square {
            0% {
                stroke-dashoffset: 240;
                fill-opacity: 0;
            }

            40% {
                stroke-dashoffset: 0;
                fill-opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                fill-opacity: 0.1;
            }
        }

        @keyframes draw-grid-lines {
            0% {
                stroke-dashoffset: 60;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 0.7;
            }
        }

        @keyframes draw-arrows-anim {
            0% {
                stroke-dashoffset: 70;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes fill-pulse {

            0%,
            40% {
                fill-opacity: 0;
            }

            100% {
                fill-opacity: 0.15;
            }
        }

        /* 6 Volume */
        .volume .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .volume .draw-cube {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-cube-lines 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .volume .draw-cube-delayed {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-cube-lines 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.3s;
        }

        .volume .draw-arrows {
            stroke-dasharray: 60;
            stroke-dashoffset: 60;
            animation: draw-vol-arrows 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.8s;
        }

        .volume .volume-fill {
            fill: var(--primary);
            fill-opacity: 0;
            animation: vol-fill-pulse 2s ease infinite alternate;
            animation-delay: 0.5s;
        }

        @keyframes draw-cube-lines {
            0% {
                stroke-dashoffset: 200;
            }

            40% {
                stroke-dashoffset: 0;
            }

            100% {
                stroke-dashoffset: 0;
            }
        }

        @keyframes draw-vol-arrows {
            0% {
                stroke-dashoffset: 60;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes vol-fill-pulse {

            0%,
            40% {
                fill-opacity: 0;
            }

            100% {
                fill-opacity: 0.15;
            }
        }

        /* 7 Speed */
        .speed .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .speed .draw-arc {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-gauge 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .speed .needle-rev {
            transform-origin: 50% 65%;
            animation: rev-engine 2s cubic-bezier(0.2, 0.8, 0.2, 1) infinite alternate;
            animation-delay: 0.5s;
        }

        .speed .motion-lines {
            stroke-dasharray: 20;
            stroke-dashoffset: 100;
            opacity: 0;
            animation: rush-lines 0.5s linear infinite;
        }

        .speed .fade-ticks {
            opacity: 0;
            animation: fade-speed-ticks 2s ease infinite alternate;
            animation-delay: 0.3s;
        }

        .speed .motion-group {
            opacity: 0;
            animation: motion-visibility 2s ease infinite alternate;
        }

        @keyframes draw-gauge {
            0% {
                stroke-dashoffset: 200;
                opacity: 0;
            }

            40% {
                stroke-dashoffset: 0;
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes rev-engine {
            0% {
                transform: rotate(-90deg);
            }

            20% {
                transform: rotate(-20deg);
            }

            40% {
                transform: rotate(-90deg);
            }

            60% {
                transform: rotate(80deg);
            }

            70% {
                transform: rotate(75deg);
            }

            80% {
                transform: rotate(85deg);
            }

            100% {
                transform: rotate(90deg);
            }
        }

        @keyframes rush-lines {
            0% {
                stroke-dashoffset: 100;
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 0;
            }
        }

        @keyframes fade-speed-ticks {

            0%,
            20% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }

        @keyframes motion-visibility {

            0%,
            50% {
                opacity: 0;
            }

            70%,
            100% {
                opacity: 1;
            }
        }

        /* 8 Digital Storage */
        .storage .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .storage .icon-fill {
            fill: var(--primary);
            stroke: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .storage .draw-chip {
            stroke-dasharray: 300;
            stroke-dashoffset: 300;
            animation: draw-storage-line 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .storage .draw-pins {
            stroke-dasharray: 50;
            stroke-dashoffset: 50;
            animation: draw-storage-line 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.3s;
        }

        .storage .capacity-fill {
            opacity: 0;
            animation: fill-capacity 2s steps(4) infinite alternate;
            animation-delay: 0.6s;
        }

        .storage .data-led {
            opacity: 0;
            animation: blink-led 0.5s steps(2) infinite;
            animation-delay: 1s;
        }

        @keyframes draw-storage-line {
            0% {
                stroke-dashoffset: 300;
                opacity: 0;
            }

            30% {
                stroke-dashoffset: 0;
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes fill-capacity {
            0% {
                opacity: 0;
                transform: scaleY(0);
            }

            20% {
                opacity: 1;
                transform: scaleY(0.25);
            }

            40% {
                opacity: 1;
                transform: scaleY(0.5);
            }

            60% {
                opacity: 1;
                transform: scaleY(0.75);
            }

            100% {
                opacity: 1;
                transform: scaleY(1);
            }
        }

        @keyframes blink-led {
            0% {
                opacity: 0;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        /* 9 Currency */
        .currency .icon-stroke {
            stroke: var(--primary);
            stroke-width: 4;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .currency .draw-symbol {
            stroke-dasharray: 250;
            stroke-dashoffset: 250;
            animation: draw-symbol-anim 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        @keyframes draw-symbol-anim {
            0% {
                stroke-dashoffset: 250;
                opacity: 0;
            }

            30% {
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        /* 10 Energy */
        .energy .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .energy .icon-fill {
            fill: var(--primary);
            stroke: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .energy .draw-shell {
            stroke-dasharray: 250;
            stroke-dashoffset: 250;
            animation: draw-energy-line 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .energy .draw-bolt {
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            opacity: 0;
            animation: draw-energy-bolt 2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
            animation-delay: 0.5s;
        }

        .energy .charge-bar {
            opacity: 0;
            animation: charge-cycle 2s steps(1) infinite alternate;
        }

        .energy .bar-1 {
            animation-delay: 0.8s;
        }

        .energy .bar-2 {
            animation-delay: 1.0s;
        }

        .energy .bar-3 {
            animation-delay: 1.2s;
        }

        .energy .bolt-pulse {
            transform-origin: center;
            animation: pulse-bolt 0.5s ease-in-out infinite alternate;
        }

        @keyframes draw-energy-line {
            0% {
                stroke-dashoffset: 250;
                opacity: 0;
            }

            30% {
                stroke-dashoffset: 0;
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes draw-energy-bolt {
            0% {
                stroke-dashoffset: 100;
                opacity: 0;
            }

            20% {
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes charge-cycle {
            0% {
                opacity: 0;
                transform: scaleX(0);
            }

            50%,
            100% {
                opacity: 1;
                transform: scaleX(1);
            }
        }

        @keyframes pulse-bolt {
            0% {
                transform: scale(0.9);
                opacity: 0.8;
            }

            100% {
                transform: scale(1.1);
                opacity: 1;
            }
        }

        /* 11 Pressure */
        .pressure .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .pressure .draw-anim {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-press-line 1.5s ease-out forwards;
        }

        .pressure .arrow-group {
            animation: press-down 2s ease-in-out infinite;
        }

        .pressure .block-combined {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            transform-origin: 50% 80px;
            animation: draw-press-line 1.5s ease-out forwards, squish-block 2s ease-in-out infinite;
        }

        @keyframes draw-press-line {
            0% {
                stroke-dashoffset: 200;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes press-down {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(15px);
            }
        }

        @keyframes squish-block {

            0%,
            100% {
                transform: scaleY(1);
            }

            50% {
                transform: scaleY(0.6);
                stroke-width: 4px;
            }
        }

        /* 12 Density */
        .density .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .density .draw-anim {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-density-line 1.5s ease-out forwards;
        }

        .density .particle-center {
            animation: pulse-center 3s ease-in-out infinite;
        }

        .density .particle-move {
            animation: compress-particles 3s ease-in-out infinite;
            transform-origin: 50px 50px;
        }

        .density .top-left {
            --x-move: 12px;
            --y-move: 12px;
        }

        .density .top-right {
            --x-move: -12px;
            --y-move: 12px;
        }

        .density .bottom-left {
            --x-move: 12px;
            --y-move: -12px;
        }

        .density .bottom-right {
            --x-move: -12px;
            --y-move: -12px;
        }

        .density .volume-box {
            stroke: var(--primary);
            opacity: 0.3;
            stroke-dasharray: 4 4;
            animation: fade-density-box 2s ease-out forwards;
        }

        @keyframes draw-density-line {
            0% {
                stroke-dashoffset: 200;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes compress-particles {

            0%,
            100% {
                transform: translate(0, 0);
            }

            50% {
                transform: translate(var(--x-move), var(--y-move));
            }
        }

        @keyframes pulse-center {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        @keyframes fade-density-box {
            0% {
                opacity: 0;
            }

            100% {
                opacity: 0.3;
            }
        }

        /* 13 Power */
        .power .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .power .draw-tower {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-structure 2s ease-out forwards;
        }

        .power .pulse-path {
            stroke: #fff;
            stroke-width: 4;
            stroke-dasharray: 10 100;
            stroke-dashoffset: 100;
            filter: drop-shadow(0 0 5px #fff) drop-shadow(0 0 10px #00ff41);
            animation: flow-pulse 1.5s linear infinite;
            opacity: 0.8;
        }

        .power .pulse-delay-1 {
            animation-delay: 0s;
        }

        .power .pulse-delay-2 {
            animation-delay: 0.5s;
        }

        .power .pulse-delay-3 {
            animation-delay: 0.2s;
        }

        .power .pulse-delay-4 {
            animation-delay: 0.7s;
        }

        @keyframes draw-structure {
            0% {
                stroke-dashoffset: 200;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes flow-pulse {
            0% {
                stroke-dashoffset: 100;
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                stroke-dashoffset: -100;
                opacity: 0;
            }
        }

        .power .tower-hum {
            transform-origin: 50% 90%;
            animation: hum 0.1s linear infinite;
        }

        @keyframes hum {
            0% {
                transform: translate(0, 0);
            }

            25% {
                transform: translate(0.5px, 0);
            }

            50% {
                transform: translate(0, 0);
            }

            75% {
                transform: translate(-0.5px, 0);
            }

            100% {
                transform: translate(0, 0);
            }
        }

        /* 14 Force */
        .force .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .force .icon-fill {
            fill: var(--primary);
            stroke: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .force .draw-frame {
            stroke-dasharray: 200;
            stroke-dashoffset: 200;
            animation: draw-force-frame 1.5s ease-out forwards;
        }

        .force .swing-left {
            transform-origin: 30px 20px;
            animation: left-cradle 1.2s linear infinite;
        }

        .force .swing-right {
            transform-origin: 70px 20px;
            animation: right-cradle 1.2s linear infinite;
        }

        .force .impact-flash {
            opacity: 0;
            transform-origin: 50% 70%;
            animation: impact-flash-anim 1.2s linear infinite;
        }

        @keyframes draw-force-frame {
            0% {
                stroke-dashoffset: 200;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes left-cradle {
            0% {
                transform: rotate(30deg);
                animation-timing-function: ease-in;
            }

            25% {
                transform: rotate(0deg);
                animation-timing-function: linear;
            }

            50% {
                transform: rotate(0deg);
                animation-timing-function: linear;
            }

            75% {
                transform: rotate(0deg);
                animation-timing-function: ease-out;
            }

            100% {
                transform: rotate(30deg);
            }
        }

        @keyframes right-cradle {
            0% {
                transform: rotate(0deg);
                animation-timing-function: linear;
            }

            25% {
                transform: rotate(0deg);
                animation-timing-function: ease-out;
            }

            50% {
                transform: rotate(-30deg);
                animation-timing-function: ease-in;
            }

            75% {
                transform: rotate(0deg);
                animation-timing-function: linear;
            }

            100% {
                transform: rotate(0deg);
            }
        }

        @keyframes impact-flash-anim {

            0%,
            24% {
                opacity: 0;
                transform: scale(0.5);
            }

            25% {
                opacity: 1;
                transform: scale(1.5);
            }

            35% {
                opacity: 0;
                transform: scale(0.5);
            }

            74% {
                opacity: 0;
                transform: scale(0.5);
            }

            75% {
                opacity: 1;
                transform: scale(1.5);
            }

            85% {
                opacity: 0;
                transform: scale(0.5);
            }

            100% {
                opacity: 0;
            }
        }

        /* 15 Frequency */
        .cat-icon .freq {
            overflow: hidden;
        }

        .freq .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .freq .wave-group {
            animation: vertical-bob 3s ease-in-out infinite alternate;
        }

        .freq .wave-line {
            stroke-dasharray: 250;
            stroke-dashoffset: 250;
            animation: draw-wave-in 2s ease-out forwards, flow-loop-wave 2s linear infinite;
        }

        .freq .wave-1 {
            animation-delay: 0s, 0s;
        }

        .freq .wave-2 {
            animation-delay: 0.1s, 0s;
        }

        .freq .wave-3 {
            animation-delay: 0.2s, 0s;
        }

        @keyframes draw-wave-in {
            0% {
                stroke-dashoffset: 250;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes flow-loop-wave {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-100px);
            }
        }

        @keyframes vertical-bob {
            0% {
                transform: translateY(-2px);
            }

            100% {
                transform: translateY(2px);
            }
        }

        /* 16 Angle */
        .angle .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .angle .icon-fill {
            fill: var(--primary);
            stroke: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .angle .draw-fixed {
            stroke-dasharray: 200;
            stroke-dashoffset: 0;
            animation: angle-draw-in 1.5s ease-out forwards;
        }

        .angle .rotating-arm {
            transform-origin: 20px 80px;
            animation: angle-swing 2.5s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .angle .angle-arc {
            stroke-width: 2;
            fill: none;
            opacity: 0.8;
            transform-origin: 20px 80px;
            transform: scaleY(-1);
            animation: arc-grow 2.5s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .angle .vertex-point {
            transform-origin: 20px 80px;
            animation: pulse-vertex 2.5s ease-in-out infinite alternate;
        }

        @keyframes angle-draw-in {
            0% {
                stroke-dashoffset: 200;
                opacity: 0;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        @keyframes angle-swing {
            0% {
                transform: rotate(-20deg);
            }

            100% {
                transform: rotate(-90deg);
            }
        }

        @keyframes arc-grow {
            0% {
                stroke-dasharray: 12.2 300;
                opacity: 0.5;
            }

            100% {
                stroke-dasharray: 55 300;
                opacity: 1;
            }
        }

        @keyframes pulse-vertex {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.5);
            }
        }

        /* 17 Data Transfer */
        .transfer .icon-stroke {
            stroke: var(--primary);
            stroke-width: 4;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .transfer .arrow-right {
            animation: slide-right-transfer 1.5s ease-in-out infinite alternate, pulse-glow-transfer 2s ease-in-out infinite;
        }

        .transfer .arrow-left {
            animation: slide-left-transfer 1.5s ease-in-out infinite alternate, pulse-glow-transfer 2s ease-in-out infinite;
        }

        @keyframes slide-right-transfer {
            0% {
                transform: translateX(-5px);
            }

            100% {
                transform: translateX(5px);
            }
        }

        @keyframes slide-left-transfer {
            0% {
                transform: translateX(5px);
            }

            100% {
                transform: translateX(-5px);
            }
        }

        @keyframes pulse-glow-transfer {

            0%,
            100% {
                filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
                opacity: 0.8;
            }

            50% {
                filter: drop-shadow(0 0 5px rgba(0, 255, 65, 0.8)) drop-shadow(0 0 10px rgba(0, 255, 65, 0.6));
                opacity: 1;
            }
        }

        /* 18 Fuel */
        .fuel .icon-stroke {
            stroke: var(--primary);
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .fuel .icon-fill {
            fill: var(--primary);
            stroke: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .fuel .fuel-tank {
            animation: tank-pulse 4s ease-in-out infinite;
        }

        .fuel .fuel-drop {
            transform-box: fill-box;
            transform-origin: center top;
            animation: drop-drip 2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
        }

        @keyframes tank-pulse {

            0%,
            100% {
                opacity: 1;
                filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
            }

            50% {
                opacity: 0.8;
                filter: drop-shadow(0 0 1px rgba(0, 255, 65, 0.3));
            }
        }

        @keyframes drop-drip {
            0% {
                transform: translateY(0) scale(0);
                opacity: 0;
            }

            20% {
                transform: translateY(3px) scale(1);
                opacity: 1;
            }

            40% {
                transform: translateY(3px) scale(1.1);
            }

            100% {
                transform: translateY(60px) scale(0.5);
                opacity: 0;
            }
        }

        /* 19 Illuminance */
        .light .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .light .light-source {
            animation: light-source-pulse 3s ease-in-out infinite alternate;
            transform-origin: center;
        }

        .light .light-rays {
            animation: light-rays-glow 3s ease-in-out infinite alternate;
            transform-origin: center;
        }

        @keyframes light-source-pulse {
            0% {
                stroke-width: 3.5;
                filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
                transform: scale(1);
            }

            100% {
                stroke-width: 4;
                filter: drop-shadow(0 0 5px rgba(0, 255, 65, 0.8)) drop-shadow(0 0 10px rgba(0, 255, 65, 0.6));
                transform: scale(1.05);
            }
        }

        @keyframes light-rays-glow {
            0% {
                opacity: 0.6;
                stroke-width: 3;
                transform: scale(0.9);
            }

            100% {
                opacity: 1;
                stroke-width: 4;
                transform: scale(1.1);
                filter: drop-shadow(0 0 6px rgba(0, 255, 65, 0.8)) drop-shadow(0 0 12px rgba(0, 255, 65, 0.6));
            }
        }

        /* 20 Sound */
        .sound .bar {
            fill: var(--primary);
            transform-origin: 50% 100%;
            animation: barBounce 1.2s ease-in-out infinite;
        }

        .sound .bar:nth-child(1) {
            animation-delay: 0s;
        }

        .sound .bar:nth-child(2) {
            animation-delay: .15s;
        }

        .sound .bar:nth-child(3) {
            animation-delay: .3s;
        }

        @keyframes barBounce {
            0% {
                transform: scaleY(.6);
            }

            50% {
                transform: scaleY(1.2);
            }

            100% {
                transform: scaleY(.6);
            }
        }

        /* 21 Typography */
        .type .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .type .draw-anim {
            stroke-dasharray: 150;
            stroke-dashoffset: 150;
            animation: type-draw-stroke 3s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }

        .type .letter-a-left {
            animation-delay: 0s;
        }

        .type .letter-a-right {
            animation-delay: 0.3s;
        }

        .type .letter-a-bar {
            animation-delay: 0.6s;
        }

        .type .letter-c {
            animation-delay: 0.9s;
        }

        .type .baseline {
            animation-delay: 1.2s;
        }

        @keyframes type-draw-stroke {
            0% {
                stroke-dashoffset: 150;
                opacity: 0;
            }

            30% {
                opacity: 1;
            }

            100% {
                stroke-dashoffset: 0;
                opacity: 1;
            }
        }

        /* 22 Cooking */
        .cook .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .cook .steam-line {
            animation: cook-rise-fade 2.5s cubic-bezier(0.4, 0, 0.2, 1) infinite;
            opacity: 0;
        }

        .cook .steam-1 {
            animation-delay: 0s;
        }

        .cook .steam-2 {
            animation-delay: 0.8s;
        }

        .cook .steam-3 {
            animation-delay: 0.4s;
        }

        @keyframes cook-rise-fade {
            0% {
                transform: translateY(0);
                opacity: 0;
            }

            25% {
                opacity: 1;
            }

            75% {
                opacity: 0.8;
            }

            100% {
                transform: translateY(-20px);
                opacity: 0;
            }
        }

        /* 23 Clothing */
        .shoe .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .shoe .t-shirt {
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.4));
        }

        .shoe .sneaker {
            animation: shoe-bounce 2s ease-in-out infinite;
            transform-origin: 70px 85px;
        }

        @keyframes shoe-bounce {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-5px) rotate(-3deg);
            }
        }

        /* 24 Time Zones */
        .tz .icon-stroke {
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            filter: drop-shadow(0 0 2px rgba(0, 255, 65, 0.6)) drop-shadow(0 0 4px rgba(0, 255, 65, 0.4));
        }

        .tz .globe-lines {
            animation: tz-globe-spin 4s linear infinite;
        }

        .tz .minute-hand {
            transform-origin: 75px 35px;
            animation: tz-clock-tick 3s linear infinite;
        }

        .tz .hour-hand {
            transform-origin: 75px 35px;
            animation: tz-clock-tick 36s linear infinite;
        }

        @keyframes tz-globe-spin {
            0% {
                transform: translateX(-20px);
            }

            100% {
                transform: translateX(20px);
            }
        }

        @keyframes tz-clock-tick {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Shared glow animation */
        @keyframes glow {

            0%,
            100% {
                filter: drop-shadow(0 0 2px var(--primary))
            }

            50% {
                filter: drop-shadow(0 0 8px var(--primary))
            }
        }

        /* =========================================
           LAYOUT & COMPONENTS
           ========================================= */
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px 60px;
            position: relative;
            z-index: 10;
        }

        /* Nav */
        nav {
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border);
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            color: #fff;
            font-size: 1.1rem;
        }

        .nav-logo img {
            height: 32px;
            width: 32px;
            filter: drop-shadow(0 0 5px var(--primary));
        }

        .hamburger {
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 30px;
        }

        .hamburger span {
            height: 2px;
            background: var(--primary);
            transition: 0.3s;
            border-radius: 2px;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(5px, -5px);
        }

        /* Menu */
        .slide-menu {
            position: fixed;
            top: 60px;
            right: -300px;
            width: 280px;
            height: calc(100vh - 60px);
            background: var(--surface);
            border-left: 1px solid var(--border);
            padding: 20px;
            transition: 0.4s var(--ease-elastic);
            z-index: 999;
            box-shadow: -10px 0 30px rgba(0, 0, 0, 0.5);
        }

        .slide-menu.open {
            right: 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            margin-bottom: 10px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.03);
            color: var(--text);
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid transparent;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--primary);
        }

        /* Hero */
        .hero {
            text-align: center;
            padding: 80px 20px 40px;
        }

        .hero-pre {
            font-size: clamp(2rem, 5vw, 4rem);
            font-weight: 800;
            letter-spacing: 4px;
            color: var(--primary);
            text-transform: uppercase;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(0, 255, 65, 0.4);
        }

        .hero-main {
            font-size: clamp(1.5rem, 4vw, 3rem);
            font-weight: 700;
            color: #fff;
            margin-bottom: 15px;
        }

        .hero-sub {
            color: var(--text-muted);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Search */
        .search-wrap {
            max-width: 600px;
            margin: 0 auto 50px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 18px 24px 18px 50px;
            border-radius: 50px;
            border: 2px solid var(--primary);
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            font-size: 1rem;
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.1);
            transition: 0.3s;
        }

        .search-input:focus {
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.3);
            outline: none;
        }

        .search-icon {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }

        .search-results {
            position: absolute;
            top: 110%;
            left: 0;
            right: 0;
            background: var(--surface);
            border: 1px solid var(--primary);
            border-radius: 12px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .search-result-item {
            padding: 12px 20px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
        }

        .search-result-item:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        /* Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
        }

        @media (min-width: 768px) {
            .grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 30px;
            }
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 25px 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s;
            position: relative;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.15);
            border-color: var(--primary);
        }

        .card-icon {
            margin-bottom: 15px;
            transition: transform 0.3s;
        }

        .card:hover .card-icon {
            transform: scale(1.1);
        }

        .card-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .card-count {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Converter View */
        .converter-ui {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 30px;
            max-width: 800px;
            margin: 0 auto;
            box-shadow: var(--shadow);
            animation: slideUp 0.4s var(--ease-out);
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .conv-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .back-btn {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
        }

        .back-btn:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        .io-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media(min-width: 768px) {
            .io-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .input-group {
            position: relative;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 0.9rem;
            font-weight: 600;
        }

        input[type="number"],
        select {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid var(--border);
            background: rgba(0, 0, 0, 0.3);
            color: var(--text);
            font-size: 1.1rem;
            font-family: var(--font-mono);
            transition: 0.3s;
            appearance: none;
        }

        input[type="number"]:focus,
        select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
        }

        .result-display {
            background: rgba(0, 255, 65, 0.05);
            border: 1px dashed var(--primary);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .result-val {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            word-break: break-all;
            font-family: var(--font-mono);
        }

        .result-unit {
            font-size: 1rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        .formula {
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 20px;
            font-style: italic;
        }

        /* Footer */
        footer {
            margin-top: 80px;
            padding: 40px 20px;
            border-top: 1px solid var(--border);
            text-align: center;
            background: rgba(0, 0, 0, 0.9);
        }

        .credits {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .credits a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 700;
        }

        /* Calculator Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: 0.3s;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .calc-box {
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 20px;
            padding: 20px;
            width: 340px;
            max-width: 90%;
            box-shadow: 0 0 40px rgba(0, 255, 65, 0.2);
            transform: scale(0.9);
            transition: 0.3s;
        }

        .modal-overlay.active .calc-box {
            transform: scale(1);
        }

        .calc-screen {
            background: #000;
            color: var(--primary);
            font-family: var(--font-mono);
            padding: 20px;
            border-radius: 10px;
            text-align: right;
            font-size: 2rem;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            overflow-x: auto;
        }

        .calc-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .c-btn {
            padding: 15px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text);
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .c-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary);
        }

        .c-btn.op {
            color: var(--primary);
            font-weight: bold;
        }

        .c-btn.eq {
            background: var(--primary);
            color: #000;
            grid-column: span 2;
        }

        /* Utils */
        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.3s forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Reference Panels */
        .ref-panel {
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-top: 10px;
            overflow: hidden;
        }

        .ref-head {
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            color: var(--primary);
        }

        .ref-body {
            padding: 0 16px;
            max-height: 0;
            transition: 0.3s ease;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.2);
        }

        .ref-panel.open .ref-body {
            padding: 16px;
            max-height: 500px;
        }

        /* ============ COMPETITION FEATURES ============ */

        /* Swap Units Button */
        .swap-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            margin: -5px auto 15px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            background: rgba(0, 40, 20, 0.6);
            color: var(--primary);
            font-size: 1.4rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .swap-btn:hover {
            background: var(--primary);
            color: #000;
            transform: rotate(180deg);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.5);
        }

        /* Recently Used Section */
        .recent-section {
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(0, 40, 20, 0.3);
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        .recent-title {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .recent-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .recent-item {
            padding: 10px 16px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .recent-item:hover {
            border-color: var(--primary);
            background: rgba(0, 255, 65, 0.08);
        }

        /* Comparison Table */
        .comparison-section {
            margin-top: 20px;
            padding: 16px;
            background: rgba(0, 30, 15, 0.4);
            border: 1px solid var(--border);
            border-radius: 12px;
        }

        .comparison-title {
            font-size: 0.9rem;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 8px;
        }

        .comparison-item {
            padding: 10px;
            background: rgba(0, 20, 10, 0.5);
            border-radius: 8px;
            text-align: center;
            font-size: 0.8rem;
        }

        .comparison-item .from-val {
            color: var(--text-muted);
        }

        .comparison-item .to-val {
            color: var(--primary);
            font-weight: 600;
            margin-top: 4px;
        }

        /* Accuracy Note */
        .accuracy-note {
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 16px;
            padding: 10px;
            background: rgba(0, 40, 20, 0.3);
            border-radius: 8px;
            border: 1px dashed var(--border);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 16px;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 18px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: rgba(0, 30, 15, 0.5);
            color: var(--text);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            border-color: var(--primary);
            background: rgba(0, 255, 65, 0.1);
        }

        .action-btn.success {
            background: var(--primary);
            color: #000;
        }

        /* Accessibility Panel */
        .access-trigger {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 48px;
            height: 48px;
            border: 2px solid var(--primary);
            border-radius: 50%;
            background: var(--surface);
            color: var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .access-trigger:hover {
            background: rgba(0, 255, 65, 0.15);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.4);
        }

        .access-panel {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background: var(--surface);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 16px;
            z-index: 1000;
            display: none;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.3);
            min-width: 200px;
        }

        .access-panel.active {
            display: block;
        }

        .access-title {
            font-size: 0.9rem;
            color: var(--primary);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .access-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .access-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            flex: 1;
        }

        .size-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border);
            border-radius: 6px;
            background: var(--surface);
            color: var(--text);
            cursor: pointer;
            font-size: 0.8rem;
        }

        .size-btn.active {
            background: var(--primary);
            color: #000;
            border-color: var(--primary);
        }

        /* Font Size Modes */
        body.font-small {
            font-size: 14px;
        }

        body.font-medium {
            font-size: 16px;
        }

        body.font-large {
            font-size: 20px;
        }

        /* High Contrast Mode */
        body.high-contrast {
            --primary: #00ff00;
            --border: #ffffff;
        }

        body.high-contrast .card,
        body.high-contrast .converter-ui {
            border-width: 3px;
        }

        /* Result Animation */
        @keyframes resultPop {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
                text-shadow: 0 0 20px rgba(0, 255, 65, 0.8);
            }

            100% {
                transform: scale(1);
            }
        }

        .result-val.animate {
            animation: resultPop 0.4s ease;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary);
            color: #000;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .toast.show {
            opacity: 1;
        }
    </style>
</head>

<body class="theme-matrix">

    <!-- Background -->
    <div class="bg-anim"></div>

    <!-- Navigation -->
    <nav>
        <div class="nav-logo">
            <img src="https://raw.githubusercontent.com/ankushchowrasia/universalunitconconverter/03eb0fa83270da69d759bf5cae2fdbf76d85d92d/universal%20unit%20converter.png"
                alt="UUC">
            <span>UNIT CONVERTER</span>
        </div>
        <div class="hamburger" onclick="toggleMenu()">
            <span></span><span></span><span></span>
        </div>
    </nav>

    <!-- Side Menu -->
    <div class="slide-menu" id="sideMenu">
        <h3 style="margin-bottom: 20px; color: var(--primary);">MENU</h3>
        <div class="menu-item" onclick="openCalc()">
            <i data-lucide="calculator"></i> Calculator
        </div>
        <div class="menu-item" onclick="toggleTheme('matrix')">
            <div style="width:15px;height:15px;background:#00FF41;border-radius:50%"></div> Matrix Theme
        </div>
        <div class="menu-item" onclick="toggleTheme('cyberpunk')">
            <div style="width:15px;height:15px;background:#ff00ff;border-radius:50%"></div> Cyberpunk Theme
        </div>
        <div class="menu-item" onclick="toggleTheme('light')">
            <div style="width:15px;height:15px;background:#fff;border-radius:50%"></div> Light Theme
        </div>
        <div class="menu-item" onclick="toggleTheme('oled')">
            <div style="width:15px;height:15px;background:#000;border:1px solid #fff;border-radius:50%"></div> OLED
            Theme
        </div>
    </div>
    <div id="overlay" onclick="toggleMenu()"
        style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:998;display:none;"></div>

    <main class="app-container">

        <!-- HOME VIEW -->
        <div id="view-home">
            <header class="hero">
                <h2 class="hero-pre">WELCOME TO</h2>
                <h1 class="hero-main">Universal Unit Converter</h1>
                <p class="hero-sub">The ultimate engineering tool. 24 Categories. 264+ Converters. Zero Latency.</p>
            </header>

            <div class="search-wrap">
                <i data-lucide="search" class="search-icon"></i>
                <input type="text" class="search-input"
                    placeholder="Search converters (e.g. 'Length', 'Watts', 'PSI')..."
                    oninput="handleSearch(this.value)">
                <div class="search-results" id="searchResults"></div>
            </div>

            <!-- Recently Used Section -->
            <div class="recent-section" id="recentSection" style="display:none;">
                <div class="recent-title"> Recently Used</div>
                <div class="recent-grid" id="recentGrid"></div>
            </div>

            <div class="grid" id="categoryGrid">
                <!-- Categories injected by JS -->
            </div>
        </div>

        <!-- CONVERTER VIEW -->
        <div id="view-converter" class="hidden">
            <div class="converter-ui">
                <div class="conv-header">
                    <button class="back-btn" onclick="goHome()">
                        <i data-lucide="arrow-left" size="16"></i> BACK
                    </button>
                    <h2 id="convTitle" style="color:var(--text); font-size:1.2rem;">Converter</h2>
                    <button class="back-btn" style="border:none; padding:8px;" onclick="openCalc()">
                        <i data-lucide="calculator"></i>
                    </button>
                </div>

                <div class="io-grid">
                    <div class="input-group">
                        <label class="input-label">FROM</label>
                        <input type="number" id="inputVal" placeholder="0" oninput="convert()">
                        <select id="unitFrom" onchange="convert()" style="margin-top:10px;"></select>
                    </div>
                    <div class="input-group">
                        <label class="input-label">TO</label>
                        <input type="number" id="outputVal" placeholder="0" readonly
                            style="opacity:0.8; cursor:pointer;" onclick="copyResult()">
                        <select id="unitTo" onchange="convert()" style="margin-top:10px;"></select>
                    </div>
                </div>

                <!-- Swap Units Button -->
                <button class="swap-btn" onclick="swapUnits()" title="Swap Units"></button>

                <div class="result-display">
                    <div class="result-val" id="resultText">0</div>
                    <div class="result-unit" id="resultUnitLabel">Units</div>
                </div>
                <div class="formula" id="formulaText"></div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="action-btn" onclick="copyFullResult()" id="copyBtn"> Copy Result</button>
                    <button class="action-btn" onclick="shareResult()"> Share</button>
                </div>

                <!-- Accuracy Note -->
                <div class="accuracy-note">
                     Accuracy: NIST Standard Values | Static (No API Delay)
                </div>

                <!-- Comparison Table -->
                <div class="comparison-section" id="comparisonSection">
                    <div class="comparison-title"> Quick Comparison</div>
                    <div class="comparison-grid" id="comparisonGrid"></div>
                </div>

                <!-- References -->
                <div id="referenceSection">
                    <div class="ref-panel">
                        <div class="ref-head" onclick="this.parentElement.classList.toggle('open')">
                            Definition <i data-lucide="chevron-down" size="16"></i>
                        </div>
                        <div class="ref-body" id="refDefinition">Select units to see definitions.</div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Calculator Modal -->
    <div class="modal-overlay" id="calcModal" onclick="if(event.target===this)closeCalc()">
        <div class="calc-box">
            <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                <span style="font-weight:bold;color:var(--primary)">CALCULATOR</span>
                <span style="cursor:pointer" onclick="closeCalc()"></span>
            </div>
            <div class="calc-screen" id="calcDisplay">0</div>
            <div class="calc-grid">
                <button class="c-btn" onclick="calcAppend('(')">(</button>
                <button class="c-btn" onclick="calcAppend(')')">)</button>
                <button class="c-btn" onclick="calcClear()">C</button>
                <button class="c-btn op" onclick="calcAppend('/')"></button>
                <button class="c-btn" onclick="calcAppend('7')">7</button>
                <button class="c-btn" onclick="calcAppend('8')">8</button>
                <button class="c-btn" onclick="calcAppend('9')">9</button>
                <button class="c-btn op" onclick="calcAppend('*')"></button>
                <button class="c-btn" onclick="calcAppend('4')">4</button>
                <button class="c-btn" onclick="calcAppend('5')">5</button>
                <button class="c-btn" onclick="calcAppend('6')">6</button>
                <button class="c-btn op" onclick="calcAppend('-')">-</button>
                <button class="c-btn" onclick="calcAppend('1')">1</button>
                <button class="c-btn" onclick="calcAppend('2')">2</button>
                <button class="c-btn" onclick="calcAppend('3')">3</button>
                <button class="c-btn op" onclick="calcAppend('+')">+</button>
                <button class="c-btn" onclick="calcAppend('0')">0</button>
                <button class="c-btn" onclick="calcAppend('.')">.</button>
                <button class="c-btn eq" onclick="calcEval()">=</button>
            </div>
            <button class="c-btn" style="width:100%; margin-top:10px; border-color:var(--primary); color:var(--primary)"
                onclick="useCalcResult()">USE RESULT</button>
        </div>
    </div>

    <footer>
        <div class="nav-logo" style="justify-content:center; margin-bottom:15px;">
            <img src="https://raw.githubusercontent.com/ankushchowrasia/universalunitconconverter/03eb0fa83270da69d759bf5cae2fdbf76d85d92d/universal%20unit%20converter.png"
                alt="UUC">
            <span>UNIVERSAL UNIT CONVERTER</span>
        </div>
        <p class="credits">
             2025 Phase-3 Finale. Designed by <a href="#">Ankush Chowrasia</a>.
        </p>
    </footer>

    <!-- Accessibility Panel -->
    <button class="access-trigger" onclick="toggleAccessPanel()" title="Accessibility Options"></button>
    <div class="access-panel" id="accessPanel">
        <div class="access-title">Accessibility</div>
        <div class="access-row">
            <span class="access-label">Font Size</span>
            <div>
                <button class="size-btn" onclick="setFontSize('small')">S</button>
                <button class="size-btn active" onclick="setFontSize('medium')">M</button>
                <button class="size-btn" onclick="setFontSize('large')">L</button>
            </div>
        </div>
        <div class="access-row">
            <span class="access-label">High Contrast</span>
            <button class="size-btn" id="contrastBtn" onclick="toggleContrast()">Off</button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">Copied!</div>

    <script>
        // =========================================
        // DATA & ICONS
        // =========================================
        const SVG_ICONS = {
            length: `<svg class="length" viewBox="0 0 100 100"><line class="icon-stroke draw-anim" x1="10" y1="40" x2="90" y2="40" /><g class="icon-stroke fade-ticks"><line x1="10" y1="40" x2="10" y2="50" /><line x1="30" y1="40" x2="30" y2="46" /><line x1="50" y1="40" x2="50" y2="52" /><line x1="70" y1="40" x2="70" y2="46" /><line x1="90" y1="40" x2="90" y2="50" /></g><g class="icon-stroke draw-anim-delayed"><line x1="10" y1="70" x2="90" y2="70" /><polyline points="15 65 10 70 15 75" /><polyline points="85 65 90 70 85 75" /></g></svg>`,
            weight: `<svg class="weight" viewBox="0 0 100 100"><path class="icon-stroke draw-anim" d="M 50 85 L 50 25 M 35 85 L 65 85" /><g class="balance-sway"><line class="icon-stroke draw-anim" x1="15" y1="25" x2="85" y2="25" /><path class="icon-stroke draw-anim-delayed" d="M 15 25 L 15 55 M 5 55 Q 15 70 25 55 Z" /><path class="icon-stroke draw-anim-delayed" d="M 85 25 L 85 55 M 75 55 Q 85 70 95 55 Z" /></g></svg>`,
            temp: `<svg class="temp" viewBox="0 0 100 100"><path class="icon-stroke draw-anim" d="M 42 25 A 8 8 0 1 1 58 25 L 58 65 A 14 14 0 1 1 42 65 Z" /><circle class="icon-fill bulb-pulse" cx="50" cy="74" r="8" /><line class="icon-stroke temp-rise" x1="50" y1="65" x2="50" y2="25" /><g class="icon-stroke fade-ticks"><line x1="65" y1="35" x2="75" y2="35" /><line x1="65" y1="45" x2="72" y2="45" /><line x1="65" y1="55" x2="75" y2="55" /></g></svg>`,
            time: `<svg class="time" viewBox="0 0 100 100"><path class="icon-stroke draw-anim" d="M 42 15 L 58 15 M 50 15 L 50 22" /><circle class="icon-stroke draw-anim" cx="50" cy="55" r="33" /><g class="icon-stroke fade-ticks"><line x1="50" y1="28" x2="50" y2="34" /><line x1="77" y1="55" x2="71" y2="55" /><line x1="50" y1="82" x2="50" y2="76" /><line x1="23" y1="55" x2="29" y2="55" /></g><g class="icon-stroke hands-anim"><line x1="50" y1="55" x2="50" y2="35" /><line x1="50" y1="55" x2="65" y2="55" /><circle cx="50" cy="55" r="1" fill="#00ff41" stroke="none" /></g></svg>`,
            area: `<svg class="area" viewBox="0 0 100 100"><rect class="icon-stroke draw-boundary area-fill" x="20" y="20" width="60" height="60" /><g class="icon-stroke draw-grid"><line x1="40" y1="20" x2="40" y2="80" /><line x1="60" y1="20" x2="60" y2="80" /><line x1="20" y1="40" x2="80" y2="40" /><line x1="20" y1="60" x2="80" y2="60" /></g><g class="icon-stroke draw-arrows"><path d="M 20 88 L 80 88 M 75 84 L 80 88 L 75 92" /><path d="M 88 80 L 88 20 M 84 25 L 88 20 L 92 25" /></g></svg>`,
            volume: `<svg class="volume" viewBox="0 0 100 100"><rect class="icon-stroke draw-cube" x="40" y="25" width="45" height="45" opacity="0.6" /><g class="icon-stroke draw-cube-delayed"><line x1="25" y1="40" x2="40" y2="25" /><line x1="70" y1="40" x2="85" y2="25" /><line x1="25" y1="85" x2="40" y2="70" /><line x1="70" y1="85" x2="85" y2="70" /></g><rect class="icon-stroke draw-cube-delayed volume-fill" x="25" y="40" width="45" height="45" /><g class="icon-stroke draw-arrows"><path d="M 25 92 L 70 92 M 65 88 L 70 92 L 65 96" /><path d="M 18 85 L 18 40 M 14 45 L 18 40 L 22 45" /><path d="M 88 68 L 95 61 M 90 61 L 95 61 L 95 66" /></g></svg>`,
            speed: `<svg class="speed" viewBox="0 0 100 100"><path class="icon-stroke draw-arc" d="M 20 65 A 35 35 0 1 1 80 65" /><g class="icon-stroke fade-ticks"><line x1="20" y1="65" x2="14" y2="65" /><line x1="50" y1="30" x2="50" y2="24" /><line x1="80" y1="65" x2="86" y2="65" /><line x1="29" y1="44" x2="25" y2="40" /><line x1="71" y1="44" x2="75" y2="40" /></g><g class="icon-stroke motion-group"><line class="motion-lines" x1="10" y1="20" x2="90" y2="20" style="animation-duration: 0.4s;" /><line class="motion-lines" x1="5" y1="10" x2="80" y2="10" style="animation-duration: 0.6s;" /><line class="motion-lines" x1="15" y1="30" x2="95" y2="30" style="animation-duration: 0.5s;" /></g><g class="needle-rev"><line class="icon-stroke" x1="50" y1="65" x2="50" y2="35" /><circle cx="50" cy="65" r="3" fill="#00ff41" stroke="none" /></g></svg>`,
            digital: `<svg class="storage" viewBox="0 0 100 100"><path class="icon-stroke draw-chip" d="M 25 15 L 65 15 L 80 30 L 80 85 L 25 85 Z" /><rect class="icon-stroke draw-chip" x="35" y="40" width="35" height="35" rx="2" stroke-width="2" /><g class="icon-stroke draw-pins" stroke-width="2"><line x1="32" y1="85" x2="32" y2="75" /><line x1="41" y1="85" x2="41" y2="75" /><line x1="50" y1="85" x2="50" y2="75" /><line x1="59" y1="85" x2="59" y2="75" /><line x1="68" y1="85" x2="68" y2="75" /></g><rect class="icon-fill capacity-fill" x="39" y="44" width="27" height="27" style="transform-origin: 50% 71px;" /><circle class="icon-fill data-led" cx="65" cy="25" r="2.5" /></svg>`,
            currency: `<svg class="currency" viewBox="0 0 100 100"><path class="icon-stroke draw-symbol" d="M 20 20 L 80 20 M 20 35 L 80 35 M 30 35 C 75 35 75 60 30 60 L 75 85" /></svg>`,
            energy: `<svg class="energy" viewBox="0 0 100 100"><path class="icon-stroke draw-shell" d="M 25 30 L 75 30 L 75 40 L 80 40 L 80 60 L 75 60 L 75 70 L 25 70 Z" /><g class="icon-fill"><rect class="charge-bar bar-1" x="30" y="35" width="12" height="30" rx="2" style="transform-origin: 36px 50px;" /><rect class="charge-bar bar-2" x="45" y="35" width="12" height="30" rx="2" style="transform-origin: 51px 50px;" /><rect class="charge-bar bar-3" x="60" y="35" width="12" height="30" rx="2" style="transform-origin: 66px 50px;" /></g><path class="icon-stroke draw-bolt bolt-pulse" stroke-width="2" fill="none" d="M 50 20 L 45 45 L 55 45 L 50 75" /></svg>`,
            pressure: `<svg class="pressure" viewBox="0 0 100 100"><line class="icon-stroke draw-anim" x1="20" y1="80" x2="80" y2="80" /><rect class="icon-stroke block-combined" x="35" y="40" width="30" height="40" /><g class="arrow-group"><line class="icon-stroke draw-anim" x1="50" y1="10" x2="50" y2="35" /><path class="icon-stroke draw-anim" d="M 40 25 L 50 35 L 60 25" /></g></svg>`,
            density: `<svg class="density" viewBox="0 0 100 100"><rect class="icon-stroke volume-box" x="10" y="10" width="80" height="80" rx="10" stroke-width="1.5" /><g class="icon-stroke draw-anim"><circle class="particle-center" cx="50" cy="50" r="6" style="transform-origin: 50px 50px;" /><circle class="particle-move top-left" cx="25" cy="25" r="6" /><circle class="particle-move top-right" cx="75" cy="25" r="6" /><circle class="particle-move bottom-left" cx="25" cy="75" r="6" /><circle class="particle-move bottom-right" cx="75" cy="75" r="6" /></g></svg>`,
            power: `<svg class="power" viewBox="0 0 100 100"><g class="tower-hum"><path class="icon-stroke draw-tower" d="M 35 90 L 50 15 L 65 90" /><line class="icon-stroke draw-tower" x1="45" y1="30" x2="55" y2="30" /><line class="icon-stroke draw-tower" x1="30" y1="45" x2="70" y2="45" /><line class="icon-stroke draw-tower" x1="25" y1="60" x2="75" y2="60" /><line class="icon-stroke draw-tower" x1="30" y1="45" x2="30" y2="50" stroke-width="2" /><line class="icon-stroke draw-tower" x1="70" y1="45" x2="70" y2="50" stroke-width="2" /></g><g class="icon-stroke" stroke-width="1.5" opacity="0.7"><path d="M -10 25 Q 20 35 45 30" /><path d="M 55 30 Q 80 35 110 25" /><path d="M -10 45 Q 15 55 30 50" /><path d="M 70 50 Q 85 55 110 45" /></g><g fill="none"><path class="pulse-path pulse-delay-1" d="M -10 25 Q 20 35 45 30" /><path class="pulse-path pulse-delay-2" d="M 55 30 Q 80 35 110 25" /><path class="pulse-path pulse-delay-3" d="M -10 45 Q 15 55 30 50" /><path class="pulse-path pulse-delay-4" d="M 70 50 Q 85 55 110 45" /></g></svg>`,
            force: `<svg class="force" viewBox="0 0 100 100"><line class="icon-stroke draw-frame" x1="20" y1="20" x2="80" y2="20" /><line class="icon-stroke draw-frame" x1="20" y1="20" x2="20" y2="25" /><line class="icon-stroke draw-frame" x1="80" y1="20" x2="80" y2="25" /><g class="swing-left"><line class="icon-stroke" x1="30" y1="20" x2="30" y2="65" stroke-width="1.5" /><circle class="icon-stroke" cx="30" cy="70" r="5" fill="#111" /><circle class="icon-fill" cx="30" cy="70" r="2" /></g><g><line class="icon-stroke draw-frame" x1="40" y1="20" x2="40" y2="65" stroke-width="1.5" /><circle class="icon-stroke" cx="40" cy="70" r="5" fill="#111" /><line class="icon-stroke draw-frame" x1="50" y1="20" x2="50" y2="65" stroke-width="1.5" /><circle class="icon-stroke" cx="50" cy="70" r="5" fill="#111" /><line class="icon-stroke draw-frame" x1="60" y1="20" x2="60" y2="65" stroke-width="1.5" /><circle class="icon-stroke" cx="60" cy="70" r="5" fill="#111" /></g><g class="swing-right"><line class="icon-stroke" x1="70" y1="20" x2="70" y2="65" stroke-width="1.5" /><circle class="icon-stroke" cx="70" cy="70" r="5" fill="#111" /><circle class="icon-fill" cx="70" cy="70" r="2" /></g><circle class="icon-fill impact-flash" cx="50" cy="70" r="10" opacity="0" /></svg>`,
            frequency: `<svg class="freq" viewBox="0 0 100 100"><g class="wave-group"><path class="icon-stroke wave-line wave-1" d="M 0 35 Q 25 20 50 35 T 100 35 T 150 35 T 200 35" /><path class="icon-stroke wave-line wave-2" d="M 0 50 Q 25 35 50 50 T 100 50 T 150 50 T 200 50" /><path class="icon-stroke wave-line wave-3" d="M 0 65 Q 25 50 50 65 T 100 65 T 150 65 T 200 65" /></g></svg>`,
            angle: `<svg class="angle" viewBox="0 0 100 100"><path class="icon-stroke draw-fixed" d="M 20 20 L 20 80 L 80 80" /><circle class="icon-stroke angle-arc" cx="20" cy="80" r="35" /><g class="icon-stroke rotating-arm"><line x1="20" y1="80" x2="65" y2="80" /><path d="M 58 74 L 65 80 L 58 86" /></g><circle class="icon-fill vertex-point" cx="20" cy="80" r="4" /></svg>`,
            data_transfer: `<svg class="transfer" viewBox="0 0 100 100"><g class="arrow-right"><line class="icon-stroke" x1="20" y1="35" x2="80" y2="35" /><path class="icon-stroke" d="M 70 25 L 80 35 L 70 45" /></g><g class="arrow-left"><line class="icon-stroke" x1="20" y1="65" x2="80" y2="65" /><path class="icon-stroke" d="M 30 55 L 20 65 L 30 75" /></g></svg>`,
            fuel: `<svg class="fuel" viewBox="0 0 100 100"><g class="fuel-tank"><path class="icon-stroke" d="M 25 35 L 75 35 L 75 85 L 25 85 Z" /><path class="icon-stroke" d="M 35 45 L 65 75" style="opacity: 0.6; stroke-width: 2;" /><path class="icon-stroke" d="M 65 45 L 35 75" style="opacity: 0.6; stroke-width: 2;" /><rect class="icon-stroke" x="32" y="42" width="36" height="36" rx="2" style="opacity: 0.6; stroke-width: 2;" /><path class="icon-stroke" d="M 28 35 L 28 25 Q 28 20 35 20 L 65 20 Q 72 20 72 25 L 72 35" /><path class="icon-stroke" d="M 42 20 L 42 35 M 58 20 L 58 35" /><path class="icon-stroke" d="M 68 22 L 82 22 L 85 28" stroke-width="3" /></g><path class="icon-fill fuel-drop" d="M 85 28 Q 80 38 85 43 Q 90 38 85 28 Z" /></svg>`,
            illuminance: `<svg class="light" viewBox="0 0 100 100"><circle class="icon-stroke light-source" cx="50" cy="50" r="18" /><g class="icon-stroke light-rays"><line x1="50" y1="20" x2="50" y2="10" /><line x1="50" y1="80" x2="50" y2="90" /><line x1="20" y1="50" x2="10" y2="50" /><line x1="80" y1="50" x2="90" y2="50" /><line x1="29" y1="29" x2="22" y2="22" /><line x1="71" y1="29" x2="78" y2="22" /><line x1="29" y1="71" x2="22" y2="78" /><line x1="71" y1="71" x2="78" y2="78" /></g></svg>`,
            sound: `<svg class="sound" viewBox="0 0 100 100"><g class="icon-stroke draw-anim"><rect x="28" y="40" width="8" height="30" rx="2" fill="#00ff41" class="bar" /><rect x="42" y="30" width="8" height="40" rx="2" fill="#00ff41" class="bar" /><rect x="56" y="35" width="8" height="35" rx="2" fill="#00ff41" class="bar" /><rect x="70" y="45" width="8" height="25" rx="2" fill="#00ff41" class="bar" /></g></svg>`,
            typography: `<svg class="type" viewBox="0 0 100 100"><path class="icon-stroke draw-anim letter-a-left" d="M 15 75 L 30 25" /><path class="icon-stroke draw-anim letter-a-right" d="M 30 25 L 45 75" /><line class="icon-stroke draw-anim letter-a-bar" x1="22" y1="55" x2="38" y2="55" /><path class="icon-stroke draw-anim letter-c" d="M 85 35 A 20 20 0 1 0 85 65" /><line class="icon-stroke draw-anim baseline" x1="10" y1="85" x2="90" y2="85" style="stroke-width: 2;" /></svg>`,
            cooking: `<svg class="cook" viewBox="0 0 100 100"><g class="pot-group"><path class="icon-stroke" d="M 25 50 L 75 50 L 75 75 Q 75 85 65 85 L 35 85 Q 25 85 25 75 Z" /><line class="icon-stroke" x1="22" y1="50" x2="78" y2="50" /><path class="icon-stroke" d="M 25 58 C 20 58 20 68 25 68" /><path class="icon-stroke" d="M 75 58 C 80 58 80 68 75 68" /></g><g class="steam-group"><path class="icon-stroke steam-line steam-1" d="M 35 40 Q 40 35 35 30 Q 30 25 35 20" /><path class="icon-stroke steam-line steam-2" d="M 50 38 Q 55 33 50 28 Q 45 23 50 18" /><path class="icon-stroke steam-line steam-3" d="M 65 40 Q 70 35 65 30 Q 60 25 65 20" /></g></svg>`,
            clothing: `<svg class="shoe" viewBox="0 0 100 100"><g class="t-shirt"><path class="icon-stroke" d="M 30 25 L 15 35 L 22 45 L 30 40 L 30 75 L 70 75 L 70 40 L 78 45 L 85 35 L 70 25 Q 50 35 30 25 Z" /><path class="icon-stroke" d="M 30 25 Q 50 35 70 25" style="stroke-width: 1.5; opacity: 0.6;" /></g><g class="sneaker"><path class="icon-stroke" style="fill: #111; stroke-width: 3;" d="M 55 85 L 88 85 Q 95 85 95 78 Q 95 72 85 70 L 75 62 L 55 65 Q 52 65 52 75 Q 52 85 55 85 Z" /><path class="icon-stroke" d="M 54 80 L 92 80" style="stroke-width: 1.5; opacity: 0.8;" /><line class="icon-stroke" x1="70" y1="65" x2="78" y2="67" style="stroke-width: 2;" /><line class="icon-stroke" x1="72" y1="70" x2="80" y2="72" style="stroke-width: 2;" /></g></svg>`,
            timezone: `<svg class="tz" viewBox="0 0 100 100"><defs><clipPath id="globe-clip"><circle cx="45" cy="55" r="30" /></clipPath></defs><circle class="icon-stroke" cx="45" cy="55" r="30" /><g clip-path="url(#globe-clip)"><g class="globe-lines"><path class="icon-stroke" d="M 15 55 Q 45 65 75 55" style="stroke-width: 2; opacity: 0.7;" /><path class="icon-stroke" d="M 15 45 Q 45 35 75 45" style="stroke-width: 2; opacity: 0.7;" /><path class="icon-stroke" d="M 45 25 Q 25 55 45 85" style="stroke-width: 2;" /><path class="icon-stroke" d="M 65 25 Q 45 55 65 85" style="stroke-width: 2;" /></g></g><circle cx="75" cy="35" r="16" fill="#111" /><circle class="icon-stroke" cx="75" cy="35" r="14" /><line class="icon-stroke minute-hand" x1="75" y1="35" x2="75" y2="25" style="stroke-width: 2.5;" /><line class="icon-stroke hour-hand" x1="75" y1="35" x2="82" y2="35" style="stroke-width: 2.5;" /><circle fill="#00ff41" cx="75" cy="35" r="2" /></svg>`
        };

        const CATEGORIES = [
            { id: 'length', name: 'Length', units: ['Meter', 'Kilometer', 'Centimeter', 'Millimeter', 'Inch', 'Foot', 'Yard', 'Mile', 'Nautical Mile'], factors: { Meter: 1, Kilometer: 1000, Centimeter: 0.01, Millimeter: 0.001, Inch: 0.0254, Foot: 0.3048, Yard: 0.9144, Mile: 1609.34, 'Nautical Mile': 1852 } },
            { id: 'weight', name: 'Weight', units: ['Kilogram', 'Gram', 'Milligram', 'Metric Ton', 'Pound', 'Ounce', 'Stone'], factors: { Kilogram: 1, Gram: 0.001, Milligram: 0.000001, 'Metric Ton': 1000, Pound: 0.453592, Ounce: 0.0283495, Stone: 6.35029 } },
            { id: 'temp', name: 'Temperature', units: ['Celsius', 'Fahrenheit', 'Kelvin'] },
            { id: 'time', name: 'Time', units: ['Second', 'Minute', 'Hour', 'Day', 'Week', 'Month', 'Year'], factors: { Second: 1, Minute: 60, Hour: 3600, Day: 86400, Week: 604800, Month: 2628000, Year: 31536000 } },
            { id: 'area', name: 'Area', units: ['Square Meter', 'Square Kilometer', 'Square Foot', 'Square Inch', 'Acre', 'Hectare'], factors: { 'Square Meter': 1, 'Square Kilometer': 1e6, 'Square Foot': 0.092903, 'Square Inch': 0.00064516, Acre: 4046.86, Hectare: 10000 } },
            { id: 'volume', name: 'Volume', units: ['Liter', 'Milliliter', 'Cubic Meter', 'Gallon (US)', 'Quart', 'Pint', 'Cup'], factors: { Liter: 1, Milliliter: 0.001, 'Cubic Meter': 1000, 'Gallon (US)': 3.78541, Quart: 0.946353, Pint: 0.473176, Cup: 0.236588 } },
            { id: 'speed', name: 'Speed', units: ['Meters/Sec', 'Km/Hour', 'Miles/Hour', 'Knots'], factors: { 'Meters/Sec': 1, 'Km/Hour': 0.277778, 'Miles/Hour': 0.44704, Knots: 0.514444 } },
            { id: 'digital', name: 'Digital Storage', units: ['Bit', 'Byte', 'Kilobyte', 'Megabyte', 'Gigabyte', 'Terabyte'], factors: { Bit: 1, Byte: 8, Kilobyte: 8192, Megabyte: 8.389e6, Gigabyte: 8.59e9, Terabyte: 8.796e12 } },
            { id: 'currency', name: 'Currency', units: ['USD', 'EUR', 'GBP', 'INR', 'JPY', 'AUD', 'CAD'], factors: { USD: 1, EUR: 1.08, GBP: 1.27, INR: 0.012, JPY: 0.0067, AUD: 0.66, CAD: 0.73 } },
            { id: 'energy', name: 'Energy', units: ['Joule', 'Kilojoule', 'Calorie', 'Kilocalorie', 'Watt-hour', 'Kilowatt-hour'], factors: { Joule: 1, Kilojoule: 1000, Calorie: 4.184, Kilocalorie: 4184, 'Watt-hour': 3600, 'Kilowatt-hour': 3.6e6 } },
            { id: 'pressure', name: 'Pressure', units: ['Pascal', 'Bar', 'PSI', 'Atmosphere'], factors: { Pascal: 1, Bar: 100000, PSI: 6894.76, Atmosphere: 101325 } },
            { id: 'density', name: 'Density', units: ['kg/m', 'g/cm', 'lb/ft'], factors: { 'kg/m': 1, 'g/cm': 1000, 'lb/ft': 16.0185 } },
            { id: 'power', name: 'Power', units: ['Watt', 'Kilowatt', 'Horsepower', 'BTU/hr'], factors: { Watt: 1, Kilowatt: 1000, Horsepower: 745.7, 'BTU/hr': 0.293071 } },
            { id: 'force', name: 'Force', units: ['Newton', 'Kilonewton', 'Pound-force'], factors: { Newton: 1, Kilonewton: 1000, 'Pound-force': 4.44822 } },
            { id: 'frequency', name: 'Frequency', units: ['Hertz', 'Kilohertz', 'Megahertz', 'Gigahertz'], factors: { Hertz: 1, Kilohertz: 1000, Megahertz: 1e6, Gigahertz: 1e9 } },
            { id: 'angle', name: 'Angle', units: ['Degree', 'Radian', 'Gradian'], factors: { Degree: 1, Radian: 57.2958, Gradian: 0.9 } },
            { id: 'data_transfer', name: 'Data Transfer', units: ['Mbps', 'Gbps', 'MB/s', 'GB/s'], factors: { Mbps: 1, Gbps: 1000, 'MB/s': 8, 'GB/s': 8000 } },
            { id: 'fuel', name: 'Fuel', units: ['MPG (US)', 'MPG (UK)', 'km/L', 'L/100km'] },
            { id: 'illuminance', name: 'Illuminance', units: ['Lux', 'Foot-candle'], factors: { Lux: 1, 'Foot-candle': 10.764 } },
            { id: 'sound', name: 'Sound', units: ['Decibel', 'Bel', 'Neper'], factors: { Decibel: 1, Bel: 10, Neper: 8.686 } },
            { id: 'typography', name: 'Typography', units: ['Pixel', 'Point', 'Em'], factors: { Pixel: 1, Point: 1.333, Em: 16 } },
            { id: 'cooking', name: 'Cooking', units: ['Cup', 'Tablespoon', 'Teaspoon', 'Milliliter'], factors: { Cup: 236.588, Tablespoon: 14.7868, Teaspoon: 4.92892, Milliliter: 1 } },
            { id: 'clothing', name: 'Shoe Size', units: ['US', 'UK', 'EU'] },
            { id: 'timezone', name: 'Time Zones', units: ['UTC', 'EST', 'PST', 'GMT', 'IST'] }
        ];

        // =========================================
        // APP LOGIC
        // =========================================
        let currentCatId = null;
        let lastValue = 0;

        function init() {
            lucide.createIcons();
            renderCategories();

            // Check for saved theme
            const savedTheme = localStorage.getItem('uuc-theme');
            if (savedTheme) toggleTheme(savedTheme);
        }

        function renderCategories() {
            const grid = document.getElementById('categoryGrid');
            grid.innerHTML = CATEGORIES.map(cat => `
                <div class="card" onclick="openConverter('${cat.id}')">
                    <div class="card-icon cat-icon">
                        ${SVG_ICONS[cat.id] || SVG_ICONS.length} 
                    </div>
                    <div class="card-title">${cat.name}</div>
                    <div class="card-count">${cat.units.length} Units</div>
                </div>
            `).join('');
        }

        function openConverter(id) {
            currentCatId = id;
            const cat = CATEGORIES.find(c => c.id === id);

            // Update UI
            document.getElementById('convTitle').innerText = cat.name;

            // Populate Selects
            const uFrom = document.getElementById('unitFrom');
            const uTo = document.getElementById('unitTo');
            uFrom.innerHTML = '';
            uTo.innerHTML = '';

            cat.units.forEach(u => {
                uFrom.add(new Option(u, u));
                uTo.add(new Option(u, u));
            });

            // Default selection different to make it interesting
            if (cat.units.length > 1) uTo.selectedIndex = 1;

            // Definition Text
            document.getElementById('refDefinition').innerText = `Standard units for measuring ${cat.name.toLowerCase()}.`;

            // Transition
            document.getElementById('view-home').classList.add('hidden');
            document.getElementById('view-converter').classList.remove('hidden');
            document.getElementById('view-converter').classList.add('fade-in');

            // Clear inputs
            document.getElementById('inputVal').value = '';
            document.getElementById('outputVal').value = '';
            document.getElementById('resultText').innerText = '0';
            document.getElementById('resultUnitLabel').innerText = cat.units[1] || cat.units[0];
            document.getElementById('formulaText').innerText = '';
        }

        function goHome() {
            document.getElementById('view-converter').classList.add('hidden');
            document.getElementById('view-home').classList.remove('hidden');
            document.getElementById('view-home').classList.add('fade-in');
            currentCatId = null;
        }

        function convert() {
            if (!currentCatId) return;
            const cat = CATEGORIES.find(c => c.id === currentCatId);
            const val = parseFloat(document.getElementById('inputVal').value);
            const from = document.getElementById('unitFrom').value;
            const to = document.getElementById('unitTo').value;

            if (isNaN(val)) {
                document.getElementById('outputVal').value = '';
                document.getElementById('resultText').innerText = '0';
                return;
            }

            lastValue = val;
            let result = 0;
            let formula = '';

            // 1. Temperature Logic
            if (currentCatId === 'temp') {
                result = convertTemp(val, from, to);
                formula = `Non-linear temperature conversion`;
            }
            // 2. Fuel Logic (L/100km is inverse)
            else if (currentCatId === 'fuel') {
                // Simplified fuel logic for demo
                if (from === to) result = val;
                else if (from === 'MPG (US)' && to === 'km/L') result = val * 0.425;
                else if (from === 'km/L' && to === 'MPG (US)') result = val * 2.352;
                else result = val; // Placeholder for complex fuel types
                formula = 'Fuel economy conversion';
            }
            // 3. Shoe Size (Approximate)
            else if (currentCatId === 'clothing') {
                if (from === to) result = val;
                else if (from === 'US' && to === 'UK') result = val - 1;
                else if (from === 'UK' && to === 'US') result = val + 1;
                else if (from === 'US' && to === 'EU') result = val + 33;
                else result = val;
                formula = 'Approximate shoe size map';
            }
            // 4. Standard Linear
            else {
                const factorFrom = cat.factors[from];
                const factorTo = cat.factors[to];

                // Base unit conversion
                const baseVal = val * factorFrom;
                result = baseVal / factorTo;

                formula = `Multiply by ${(factorFrom / factorTo).toPrecision(4)}`;
            }

            // Formatting
            const displayRes = parseFloat(result.toPrecision(6)); // Avoid floating point junk
            document.getElementById('outputVal').value = displayRes;
            document.getElementById('resultText').innerText = displayRes;
            document.getElementById('resultUnitLabel').innerText = to;
            document.getElementById('formulaText').innerText = formula;
        }

        function convertTemp(val, from, to) {
            if (from === to) return val;
            let c = val;
            // To Celsius
            if (from === 'Fahrenheit') c = (val - 32) * 5 / 9;
            if (from === 'Kelvin') c = val - 273.15;
            // From Celsius
            if (to === 'Fahrenheit') return (c * 9 / 5) + 32;
            if (to === 'Kelvin') return c + 273.15;
            return c;
        }

        // =========================================
        // UI INTERACTIONS
        // =========================================
        function toggleMenu() {
            document.getElementById('sideMenu').classList.toggle('open');
            const ol = document.getElementById('overlay');
            ol.style.display = ol.style.display === 'none' ? 'block' : 'none';
        }

        function toggleTheme(themeName) {
            document.body.className = `theme-${themeName}`;
            localStorage.setItem('uuc-theme', themeName);
            toggleMenu(); // Close menu
        }

        function handleSearch(query) {
            query = query.toLowerCase();
            const resBox = document.getElementById('searchResults');
            resBox.innerHTML = '';

            if (query.length < 2) {
                resBox.style.display = 'none';
                return;
            }

            const hits = CATEGORIES.filter(c => c.name.toLowerCase().includes(query) || c.units.some(u => u.toLowerCase().includes(query)));

            if (hits.length > 0) {
                resBox.style.display = 'block';
                resBox.innerHTML = hits.map(h => `
                    <div class="search-result-item" onclick="openConverter('${h.id}'); document.getElementById('searchResults').style.display='none'">
                        <strong>${h.name}</strong>
                    </div>
                `).join('');
            } else {
                resBox.style.display = 'none';
            }
        }

        function copyResult() {
            const v = document.getElementById('outputVal');
            v.select();
            document.execCommand('copy');
            alert('Copied result to clipboard!');
        }

        // =========================================
        // CALCULATOR LOGIC
        // =========================================
        let calcExpr = '';
        function openCalc() { document.getElementById('calcModal').classList.add('active'); }
        function closeCalc() { document.getElementById('calcModal').classList.remove('active'); }
        function calcAppend(char) {
            calcExpr += char;
            document.getElementById('calcDisplay').innerText = calcExpr;
        }
        function calcClear() {
            calcExpr = '';
            document.getElementById('calcDisplay').innerText = '0';
        }
        function calcEval() {
            try {
                const res = eval(calcExpr); // Safe in this contained context
                calcExpr = res.toString();
                document.getElementById('calcDisplay').innerText = calcExpr;
            } catch (e) {
                document.getElementById('calcDisplay').innerText = 'Err';
                setTimeout(calcClear, 1000);
            }
        }
        function useCalcResult() {
            if (currentCatId) {
                document.getElementById('inputVal').value = calcExpr;
                convert();
                closeCalc();
            } else {
                alert('Open a converter first.');
                closeCalc();
            }
        }

        // =========================================
        // COMPETITION FEATURES
        // =========================================

        // Recently Used Storage
        let recentConverters = JSON.parse(localStorage.getItem('uuc-recent') || '[]');

        function addToRecent(catId) {
            // Remove if already exists
            recentConverters = recentConverters.filter(r => r !== catId);
            // Add to front
            recentConverters.unshift(catId);
            // Keep only 5
            if (recentConverters.length > 5) recentConverters.pop();
            localStorage.setItem('uuc-recent', JSON.stringify(recentConverters));
            renderRecentConverters();
        }

        function renderRecentConverters() {
            const section = document.getElementById('recentSection');
            const grid = document.getElementById('recentGrid');

            if (recentConverters.length === 0) {
                section.style.display = 'none';
                return;
            }

            section.style.display = 'block';
            grid.innerHTML = recentConverters.map(id => {
                const cat = CATEGORIES.find(c => c.id === id);
                return cat ? `<div class="recent-item" onclick="openConverter('${id}')">${cat.name}</div>` : '';
            }).join('');
        }

        // Swap Units
        function swapUnits() {
            const from = document.getElementById('unitFrom');
            const to = document.getElementById('unitTo');
            const temp = from.value;
            from.value = to.value;
            to.value = temp;
            convert();
        }

        // Comparison Table
        function updateComparison() {
            if (!currentCatId) return;
            const cat = CATEGORIES.find(c => c.id === currentCatId);
            const from = document.getElementById('unitFrom').value;
            const to = document.getElementById('unitTo').value;
            const grid = document.getElementById('comparisonGrid');

            const values = [1, 5, 10, 50, 100];
            grid.innerHTML = values.map(v => {
                let result;
                if (currentCatId === 'temp') {
                    result = convertTemp(v, from, to);
                } else if (cat.factors) {
                    result = (v * cat.factors[from]) / cat.factors[to];
                } else {
                    result = v;
                }
                const displayRes = parseFloat(result.toPrecision(4));
                return `
                    <div class="comparison-item">
                        <div class="from-val">${v} ${from}</div>
                        <div class="to-val">${displayRes} ${to}</div>
                    </div>
                `;
            }).join('');
        }

        // Enhanced Copy
        function copyFullResult() {
            const val = document.getElementById('inputVal').value;
            const from = document.getElementById('unitFrom').value;
            const result = document.getElementById('outputVal').value;
            const to = document.getElementById('unitTo').value;
            const formula = document.getElementById('formulaText').innerText;

            const text = `${val} ${from} = ${result} ${to}\n${formula}`;

            navigator.clipboard.writeText(text).then(() => {
                showToast('Copied to clipboard!');
                document.getElementById('copyBtn').classList.add('success');
                setTimeout(() => document.getElementById('copyBtn').classList.remove('success'), 1500);
            });
        }

        // Share Result
        function shareResult() {
            const val = document.getElementById('inputVal').value;
            const from = document.getElementById('unitFrom').value;
            const result = document.getElementById('outputVal').value;
            const to = document.getElementById('unitTo').value;

            const text = `${val} ${from} = ${result} ${to} - Universal Unit Converter`;

            if (navigator.share) {
                navigator.share({ title: 'Unit Conversion', text: text }).catch(() => { });
            } else {
                navigator.clipboard.writeText(text).then(() => showToast('Link copied!'));
            }
        }

        // Toast Notification
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        // Accessibility Functions
        function toggleAccessPanel() {
            document.getElementById('accessPanel').classList.toggle('active');
        }

        function setFontSize(size) {
            document.body.classList.remove('font-small', 'font-medium', 'font-large');
            document.body.classList.add('font-' + size);

            // Update active button
            document.querySelectorAll('.access-row .size-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            localStorage.setItem('uuc-fontsize', size);
        }

        function toggleContrast() {
            const btn = document.getElementById('contrastBtn');
            if (document.body.classList.contains('high-contrast')) {
                document.body.classList.remove('high-contrast');
                btn.innerText = 'Off';
                btn.classList.remove('active');
            } else {
                document.body.classList.add('high-contrast');
                btn.innerText = 'On';
                btn.classList.add('active');
            }
        }

        // Result Animation
        function animateResult() {
            const el = document.getElementById('resultText');
            el.classList.add('animate');
            setTimeout(() => el.classList.remove('animate'), 400);
        }

        // Override original openConverter to add tracking and comparison
        const originalOpenConverter = openConverter;
        openConverter = function (id) {
            addToRecent(id);
            originalOpenConverter(id);
            setTimeout(updateComparison, 100);
        };

        // Override convert to add animation and comparison update
        const originalConvert = convert;
        convert = function () {
            originalConvert();
            animateResult();
            updateComparison();
        };

        // Load saved preferences on init
        const originalInit = init;
        init = function () {
            originalInit();
            renderRecentConverters();

            // Load font size
            const savedSize = localStorage.getItem('uuc-fontsize');
            if (savedSize) {
                document.body.classList.add('font-' + savedSize);
            }
        };

        // Start App
        window.addEventListener('DOMContentLoaded', init);

    </script>
</body>

</html>
